<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Where the data science related jobs are? (Part 1)</title>
        <link rel="stylesheet" href="https://sedeh.github.io/theme/css/main.css" />
        <link href="https://sedeh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Samuel Edeh's Blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://sedeh.github.io/">Samuel Edeh's Blog </a></h1>
                <nav><ul>
                    <li class="active"><a href="https://sedeh.github.io/category/data-analysis.html">data analysis</a></li>
                    <li><a href="https://sedeh.github.io/category/machine-learning.html">machine learning</a></li>
                    <li><a href="https://sedeh.github.io/category/multiprocessing.html">multiprocessing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://sedeh.github.io/where-the-datascience-jobs-are-part1.html" rel="bookmark"
           title="Permalink to Where the data science related jobs are? (Part 1)">Where the data science related jobs are? (Part 1)</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-22T20:00:00-05:00">
                Published: Wed 22 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sedeh.github.io/author/samuel-edeh.html">Samuel Edeh</a>
        </address>
<p>In <a href="https://sedeh.github.io/category/data-analysis.html">data analysis</a>.</p>

</footer><!-- /.post-info -->      <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Where-the-data-science-related-jobs-are?-(Part-1)">Where the data science related jobs are? (Part 1)<a class="anchor-link" href="#Where-the-data-science-related-jobs-are?-(Part-1)">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post, we're going to curate, clean and enrich messy work visa data from the U.S. Department of Labor (DOL). In the next installment, <a href="https://sedeh.github.io/where-the-datascience-jobs-are-part2.html">Where the data science related jobs are (part 2)</a>, we'll probe the prepped dataset for insights and trends in data science related jobs, including:</p>
<ul>
<li>The Top 10 and Bottom 10 States for Data Science Related Jobs</li>
<li>The Top Paying States for Data Science Related Jobs</li>
<li>The Top Paying Companies for Data Science Related Jobs</li>
</ul>
<p>And more.</p>
<p>When a U.S. company wants to hire a non-U.S. worker, the company is required to file a work visa (H1B) or permanent residency (greencard) application with DOL. As part of the application, the company must disclose how much it will pay the non-U.S. worker. The company is also required to disclose the <code>Prevailing Wage</code> for the job, i.e. how much U.S. workers in the same or similar positions are being paid. The idea is to ensure that hiring non-U.S. workers does not negatively affect the job market for U.S. workers.</p>
<p>We'll take advantage of this publicly available data to explore information about data science related jobs. For this analysis, we're going to focus on H1B applications from <strong>2002 to 2015</strong>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up">Set up<a class="anchor-link" href="#Set-up">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, let's import the packages we'll need and set things up.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>

<span class="c"># For now, let's turn off panda's warning</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="bp">None</span> 

<span class="c"># Snippets like this is used thruout the code to get idea of runtime for different parts of the pipeline</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's also get some system information to help with any troubleshooting issues in the likely event you're running this code in a different environment than the one I used. I tested this code on an Amazon EC2 m4.2xlarge instance.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="o">!</span>python --version
<span class="k">print</span><span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"cpu cores: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Python 3.5.2 :: Anaconda 4.1.1 (64-bit)
Linux-3.13.0-92-generic-x86_64-with-debian-jessie-sid
cpu cores: 8
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-data">Load data<a class="anchor-link" href="#Load-data">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Python script to download the data is <a href="https://github.com/sedeh/github.io/blob/master/resources/h1bdata_download.py">here</a>. The data is fairly large at <strong>864 mb</strong>. Let's read it in and see what it looks like.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">h1bdataDF</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">'h1bdataDF.pkl'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">h1bdataDF</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"h1bdataDF has {0} rows and {1} columns"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h1bdataDF</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h1bdataDF</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>

        Submitted_Date      Case_Number                Employer_Name  \
0  2002-01-14 09:46:00  I-02014-0000001             Monsanto Company   
1  2002-01-14 09:49:00  I-02014-0000003            Priceline.com LLC   
2  2002-01-14 09:58:00  I-02014-0000005     Vestrust Securities L.P.   
3  2002-01-14 10:08:00  I-02014-0000007  Cleveland Clinic Foundation   
4  2002-01-14 10:08:00  I-02014-0000009      World Data Incorporated   

  Employer_City Employer_State Employer_Postal_Code  \
0     St. Louis             MO           63167        
1       Norwalk             CT           06954        
2  Coral Gables             FL           33134        
3     Cleveland             OH           44195        
4    Washington             DC           20036        

                        Job_Title Approval_Status     Wage_Rate  \
0             MOLECULAR BIOLOGIST       Certified   66700.00000   
1     Principal Software Engineer       Certified  123936.00000   
2  Associate Sales & Distribution       Certified   40000.00000   
3              resident physician       Certified   35995.00000   
4         Market Research Analyst       Certified   35608.00000   

  Wage_Rate_Unit Part_Time     Work_City Work_State Prevailing_Wage  
0           Year         N     ST. LOUIS         MO     38869.00000  
1           Year         N       Norwalk         CT     70138.00000  
2           Year         N  Coral Gables         FL     35298.00000  
3           Year         N     Cleveland         OH     37208.00000  
4           Year         N    Washington         DC     37482.00000  


h1bdataDF has 5231213 rows and 14 columns


</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filter-data">Filter data<a class="anchor-link" href="#Filter-data">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So we've about 5 million records. Let's remove any duplicate applications there may be in the record.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">h1bdataDF2</span> <span class="o">=</span> <span class="n">h1bdataDF</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s">'Case_Number'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s">'last'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"h1bdataDF2 has {0} rows and {1} columns"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h1bdataDF2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h1bdataDF2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>

h1bdataDF2 has 5133079 rows and 14 columns
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see the available options for <code>Approval_Status</code> column.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">h1bdataDF</span><span class="o">.</span><span class="n">Approval_Status</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[5]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([&apos;Certified&apos;, &apos;Denied&apos;, None, &apos;32000.00000&apos;, &apos;Pending&apos;, &apos;Hold&apos;,
       &apos;Debarred&apos;, &apos;&apos;, &apos;roye@fragomen.com&apos;, &apos;omboko@jacksonlewis.com&apos;,
       &apos;aespiritusanto@fragomen.c&apos;, &apos;mkwok@mltsf.com&apos;, &apos;DENIED&apos;,
       &apos;CERTIFIED&apos;, &apos;WITHDRAWN&apos;, &apos;CERTIFIED-WITHDRAWN&apos;,
       &apos;PENDING QUALITY AND COMPLIANCE REVIEW - UNASSIGNED&apos;, &apos;REJECTED&apos;,
       &apos;INVALIDATED&apos;], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For our purpose, it makes sense to keep only applications that were <code>certified</code>. For example, a <code>denied</code> application does not give us a lot of confidence about the quality of the application. Before we do that, we need to first remove rows with <code>None</code> in <code>Approval_Status</code> column.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">filteredDF</span> <span class="o">=</span> <span class="n">h1bdataDF2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Approval_Status'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"filteredDF: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filteredDF</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">certifiedDF</span> <span class="o">=</span> <span class="n">filteredDF</span><span class="p">[</span><span class="n">filteredDF</span><span class="o">.</span><span class="n">Approval_Status</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">'certified'</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="s">"certifiedDF: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">certifiedDF</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>filteredDF: (5133076, 14)
certifiedDF: (4882580, 14)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Categorize-data-science-related-jobs">Categorize data science related jobs<a class="anchor-link" href="#Categorize-data-science-related-jobs">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use <code>Job_Title</code> column to select data science related jobs. Before we start doing anything with that column, let's first make sure it contains only <code>string</code>s.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">rows_with_strings</span>  <span class="o">=</span> <span class="n">certifiedDF</span><span class="p">[[</span><span class="s">"Job_Title"</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
       <span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> 
          <span class="nb">any</span><span class="p">([</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">row</span> <span class="p">])</span>
       <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    
<span class="n">df_with_no_strings</span> <span class="o">=</span> <span class="n">certifiedDF</span><span class="p">[[</span><span class="s">"Job_Title"</span><span class="p">]][</span><span class="o">~</span><span class="n">rows_with_strings</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_with_no_strings</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>        Job_Title
1780173   66007.9
1802719     75483
1817997     27.89
1839158     71400
1891782    541613
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems some job titles were entered as <code>float</code>s. Let's clean out all <code>float</code> job titles.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">certifiedDF2</span> <span class="o">=</span> <span class="n">certifiedDF</span><span class="p">[</span><span class="n">rows_with_strings</span><span class="p">]</span>
<span class="n">certifiedDF2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(4882528, 14)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we're ready to select and categorize data science related jobs. I chose the categorization criteria based on my view and research of the data science field. A better approach is perhaps to do some pre-clustering to see if interesting patterns emerge around the job titles. There isn't much context/synopsis with the job titles for clustering to give great results. In any case, my categorization criteria isn't perfect and I'm open to your ideas on this.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">titles_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">'data analyst'</span><span class="p">:</span> <span class="s">'data analyst'</span><span class="p">,</span> <span class="s">'business analyst'</span><span class="p">:</span><span class="s">'business analyst'</span><span class="p">,</span>
               <span class="s">'informatic'</span><span class="p">:</span> <span class="s">'informatics'</span><span class="p">,</span> <span class="s">'operations research'</span><span class="p">:</span><span class="s">'operations research'</span><span class="p">,</span>
               <span class="s">'data scien'</span><span class="p">:</span> <span class="s">'data scientist'</span><span class="p">,</span> <span class="s">'intelligence'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span> 
               <span class="s">'analytics'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span> <span class="s">'data consultan'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span> 
               <span class="s">'data manage'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span><span class="s">'reporting & analysis'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span>
               <span class="s">'data min'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span><span class="s">'reporting and analysis'</span><span class="p">:</span> <span class="s">'business intelligence'</span><span class="p">,</span>
               <span class="s">'database analyst'</span><span class="p">:</span><span class="s">'data architect/engineer'</span><span class="p">,</span> <span class="s">'data architect'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span>
               <span class="s">'data engineer'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span><span class="s">'data warehous'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span>
               <span class="s">'database admin'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span> <span class="s">'datawarehous'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span> 
               <span class="s">'data model'</span><span class="p">:</span> <span class="s">'data architect/engineer'</span><span class="p">,</span><span class="s">'etl developer'</span><span class="p">:</span><span class="s">'data architect/engineer'</span><span class="p">,</span> 
               <span class="s">'market research analyst'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'market analyst'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> 
               <span class="s">'customer insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'market insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'consumer insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'marketing insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'insights analyst'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'analytic insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'strategy and insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'mkt. res. analyst'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'marketing & insights'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'global insights'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'insights & analytic'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'strategy and insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'marketing & insight'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span><span class="s">'insights & analytic'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'health care analyst'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'healthcare analyst'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'quantitative analyst'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'financial analyst'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'marketing analyst'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'management analyst'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> 
               <span class="s">'business development'</span><span class="p">:</span> <span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'consumer insight'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'analytic insight'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span> <span class="s">'data strateg'</span><span class="p">:</span><span class="s">'market analyst'</span><span class="p">,</span>
               <span class="s">'decision scien'</span><span class="p">:</span><span class="s">'data scientist'</span><span class="p">}</span>

<span class="n">titles_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">certifiedDF2</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Job_Title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">currentTitle</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">titles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">title</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">currentTitle</span><span class="p">:</span>
        <span class="n">titles_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentTitle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">titles_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"non data science related"</span><span class="p">)</span>
        
<span class="n">certifiedDF2</span><span class="p">[</span><span class="s">"Job_Title_revised"</span><span class="p">]</span> <span class="o">=</span> <span class="n">titles_list</span>

<span class="c"># Filter out non data science jobs</span>
<span class="n">dsJobsDF</span> <span class="o">=</span> <span class="n">certifiedDF2</span><span class="p">[</span><span class="n">certifiedDF2</span><span class="o">.</span><span class="n">Job_Title_revised</span> <span class="o">!=</span> <span class="s">"non data science related"</span><span class="p">]</span>
<span class="n">dsJobsDF</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"dsJobsDF shape: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time to categorize data science related jobs --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>dsJobsDF shape: (285421, 15)
Time to categorize data science related jobs --- 499.87189054489136 seconds ---
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Standardize-salary">Standardize salary<a class="anchor-link" href="#Standardize-salary">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at <code>Wage_Rate</code> column and see if any standardization is necessary.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF</span><span class="o">.</span><span class="n">Wage_Rate_Unit</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&apos;year&apos; &apos;hour&apos; &apos;2 weeks&apos; &apos;month&apos; &apos;week&apos; &apos;bi-weekly&apos; &apos;yr&apos; &apos;hr&apos; &apos;wk&apos; &apos;mth&apos;
 &apos;bi&apos;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wage rates range from hourly, weekly, bi-weekly, monthly to yearly. Let's standardize to yearly.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">dsJobsDF2</span> <span class="o">=</span> <span class="n">dsJobsDF</span>

<span class="c"># Using regex, remove any special characters such as hyphen or dollar sign in the wage columns.</span>
<span class="c"># Such characters are common in columns that contain monetary data such as the wage columns here. </span>
<span class="c"># Before applying regex, ensure the columns are of string type.</span>
<span class="c"># And remove rows with empty cells in the wage columns.</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">dsJobsDF2</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">])</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">dsJobsDF2</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">])</span>

<span class="c"># Remove '$' and '-' signs from Wage_Rate column</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Wage_Rate'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\$|-.*'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="c"># Remove '$' and '-' signs from Prevailing_Wage column</span>
<span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="p">[</span><span class="s">'Prevailing_Wage'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\$|-.*'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        
<span class="c"># Convert the cleaned wage columns to float</span>
<span class="n">dsJobsDF2</span><span class="p">[[</span><span class="s">'Wage_Rate'</span><span class="p">,</span><span class="s">'Prevailing_Wage'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dsJobsDF2</span><span class="p">[[</span><span class="s">'Wage_Rate'</span><span class="p">,</span><span class="s">'Prevailing_Wage'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'dsJobsDF2: {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time to clean wage columns --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>

<span class="c"># Now we can standardize to yearly</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">salary_offered</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">salary_prevailing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dsJobsDF2</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate_Unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'y'</span><span class="p">:</span>
        <span class="n">salary_offered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate</span><span class="p">)</span>
        <span class="n">salary_prevailing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Prevailing_Wage</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate_Unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'m'</span><span class="p">:</span>
        <span class="n">salary_offered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">salary_prevailing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Prevailing_Wage</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate_Unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'bi'</span><span class="p">,</span> <span class="s">'2 weeks'</span><span class="p">,</span> <span class="s">'bi-weekly'</span><span class="p">]:</span>
        <span class="n">salary_offered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate</span> <span class="o">*</span> <span class="mi">26</span><span class="p">)</span> <span class="c"># Assumes 52 work wks/yr</span>
        <span class="n">salary_prevailing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Prevailing_Wage</span> <span class="o">*</span> <span class="mi">26</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate_Unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'w'</span><span class="p">:</span>
        <span class="n">salary_offered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate</span> <span class="o">*</span> <span class="mi">52</span><span class="p">)</span> <span class="c"># Assumes 52 work wks/yr</span>
        <span class="n">salary_prevailing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Prevailing_Wage</span> <span class="o">*</span> <span class="mi">52</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">salary_offered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Wage_Rate</span> <span class="o">*</span> <span class="mi">2080</span><span class="p">)</span> <span class="c"># This handles the hourly rates. Assumes 52 work wks of 40 hrs/wk</span>
        <span class="n">salary_prevailing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Prevailing_Wage</span> <span class="o">*</span> <span class="mi">2080</span><span class="p">)</span>

<span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF2</span>
<span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Offered"</span><span class="p">]</span> <span class="o">=</span> <span class="n">salary_offered</span>
<span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Prevailing"</span><span class="p">]</span> <span class="o">=</span> <span class="n">salary_prevailing</span>

<span class="c"># Let's remove any rows without salary Wage information</span>
<span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Salary_Offered'</span><span class="p">])</span>
<span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Salary_Prevailing'</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="s">'dsJobsDF3: {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># Resets row index so they start from 0</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time to standardize salary --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>dsJobsDF2: (285413, 15)
Time to clean wage columns --- 1.7312259674072266 seconds ---
dsJobsDF3: (285413, 17)
Time to standardize salary --- 37.64387631416321 seconds ---
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's get some descriptive statistics on <code>Salary_Offered</code> column to see the range of salaries we're dealing with here.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Offered"</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Offered"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>count    2.854130e+05
mean     1.623086e+05
std      4.644013e+06
min      1.538000e+01
25%      4.761100e+04
50%      6.000000e+04
75%      7.631500e+04
max      1.322880e+09
Name: Salary_Offered, dtype: float64


60000.0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow, the maximum annual salary is <strong>1.3 billion</strong>! At the other extreme, the minimum is <strong>15.4</strong>. These are likely due to entry errors; we rarely run into people who are paid these kinds of salaries.</p>
<p>The median salary, which is <strong>60000.0</strong>, is a reasonable reflection of the center of the distribution. For our analysis, we'll consider any salary as unlilkely (or an <code>outlier</code>) if it's less than <strong>23760</strong> or more than <strong>10</strong> times the median. I'm assuming that a data professional is at least making <strong>2</strong> times above the federal poverty line which is at least <strong>11,880</strong> in 2016 (<strong>2</strong> x <strong>11,880</strong> = <strong>23760</strong>).</p>
<p>The idea is that we want to consider salaries that are typical for the population. Investigating the outlying values can be a study in and of itself.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Let's keep salaries that are greater than 23760 but less than 10 * the median salary</span>
<span class="n">med_offered</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Offered"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">med_prevailing</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="p">[</span><span class="s">"Salary_Prevailing"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="p">[(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">Salary_Offered</span> <span class="o">></span> <span class="mi">23760</span><span class="p">)</span> <span class="o">&</span> <span class="p">(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">Salary_Offered</span> <span class="o"><</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">med_offered</span><span class="p">)]</span>
<span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="p">[(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">Salary_Prevailing</span> <span class="o">></span> <span class="mi">23760</span><span class="p">)</span> <span class="o">&</span> <span class="p">(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">Salary_Prevailing</span> <span class="o"><</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">med_prevailing</span><span class="p">)]</span>
<span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[13]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(283338, 17)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Add-price-parity-information">Add price parity information<a class="anchor-link" href="#Add-price-parity-information">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's a good idea to adjust salary to reflect regional price parity (inflation). Let's get regional inflation data from the Bureau of Economic Analysis, www.bea.gov.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://www.bea.gov/newsreleases/regional/rpp/2015/xls/rpp0615.xlsx'</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">parityDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">parityDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">parityDF</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">parityDF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"State"</span><span class="p">,</span> <span class="s">"2012"</span><span class="p">,</span> <span class="s">"2013"</span><span class="p">]</span>
<span class="n">parityDF</span><span class="p">[</span><span class="s">'Price_Deflator'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">parityDF</span><span class="p">[</span><span class="s">'2012'</span><span class="p">]</span> <span class="o">+</span> <span class="n">parityDF</span><span class="p">[</span><span class="s">'2013'</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> 
<span class="n">parityDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">parityDF</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"parityDF shape: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time to read and clean BEA data --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>parityDF shape: (285421, 15)
Time to read and clean BEA data --- 0.9652659893035889 seconds ---
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's what the price parity data looks like.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">parityDF</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>        State  Price_Deflator
0     Alabama           93.65
1      Alaska          113.15
2     Arizona          103.80
3    Arkansas           93.30
4  California          120.00
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're almost ready to merge the price parity information with the salary data. The common column between both data frames is <code>State</code> and we should take a look at <code>State</code> columns in both data frames to make sure they match.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">Work_State</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&apos;DC&apos; &apos;CA&apos; &apos;MO&apos; &apos;TX&apos; &apos;NY&apos; &apos;IL&apos; &apos;MN&apos; &apos;MD&apos; &apos;NJ&apos; &apos;MA&apos; &apos;FL&apos; &apos;CT&apos; &apos;WA&apos; &apos;NC&apos; &apos;VA&apos;
 &apos;PA&apos; &apos;DE&apos; &apos;KY&apos; &apos;GA&apos; &apos;AZ&apos; &apos;OH&apos; &apos;IN&apos; &apos;TN&apos; &apos;NH&apos; &apos;OR&apos; &apos;MS&apos; &apos;AL&apos; &apos;NV&apos; &apos;MI&apos; &apos;WI&apos;
 &apos;SC&apos; &apos;CO&apos; &apos;OK&apos; &apos;KS&apos; &apos;LA&apos; &apos;ID&apos; &apos;AR&apos; &apos;IA&apos; &apos;RI&apos; &apos;HI&apos; &apos;UT&apos; &apos;WY&apos; &apos;AK&apos; &apos;WV&apos; &apos;PW&apos;
 &apos;NE&apos; &apos;PR&apos; &apos;ND&apos; &apos;SD&apos; &apos;VT&apos; &apos;NM&apos; &apos;ME&apos; &apos;MT&apos; &apos;VI&apos; &apos;FM&apos; &apos;AS&apos; &apos;MH&apos; &apos;GU&apos; &apos;MP&apos;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">parityDF</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&apos;Alabama&apos; &apos;Alaska&apos; &apos;Arizona&apos; &apos;Arkansas&apos; &apos;California&apos; &apos;Colorado&apos;
 &apos;Connecticut&apos; &apos;Delaware&apos; &apos;District of Columbia&apos; &apos;Florida&apos; &apos;Georgia&apos;
 &apos;Hawaii&apos; &apos;Idaho&apos; &apos;Illinois&apos; &apos;Indiana&apos; &apos;Iowa&apos; &apos;Kansas&apos; &apos;Kentucky&apos;
 &apos;Louisiana&apos; &apos;Maine&apos; &apos;Maryland&apos; &apos;Massachusetts&apos; &apos;Michigan&apos; &apos;Minnesota&apos;
 &apos;Mississippi&apos; &apos;Missouri&apos; &apos;Montana&apos; &apos;Nebraska&apos; &apos;Nevada&apos; &apos;New Hampshire&apos;
 &apos;New Jersey&apos; &apos;New Mexico&apos; &apos;New York&apos; &apos;North Carolina&apos; &apos;North Dakota&apos;
 &apos;Ohio&apos; &apos;Oklahoma&apos; &apos;Oregon&apos; &apos;Pennsylvania&apos; &apos;Rhode Island&apos; &apos;South Carolina&apos;
 &apos;South Dakota&apos; &apos;Tennessee&apos; &apos;Texas&apos; &apos;Utah&apos; &apos;Vermont&apos; &apos;Virginia&apos;
 &apos;Washington&apos; &apos;West Virginia&apos; &apos;Wisconsin&apos; &apos;Wyoming&apos; nan &apos;Maximum&apos; &apos;Minimum&apos;
 &apos;Range&apos; &apos;Source: U.S. Bureau of Economic Analysis&apos;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice two things. First, the price parity dataset contains extraneous rows, <code>maximum</code>, <code>minimum</code>, <code>range</code> and <code>nan</code>. Second, the two datasets use different formats for state names.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's address the second issue and convert state abbreviation in the work visa dataset to state full name using the list <a href="https://raw.githubusercontent.com/sedeh/github.io/master/resources/states.txt">here</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dsJobsDF3</span> <span class="o">=</span> <span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'Employer_State'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">'dsJobsDF3: {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">'https://raw.githubusercontent.com/sedeh/github.io/master/resources/states.txt'</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">state_names_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">state_code</span><span class="p">,</span> <span class="n">state_name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">":"</span><span class="p">)</span>
    <span class="n">state_names_dict</span><span class="p">[</span><span class="n">state_code</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">state_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="n">state_names_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dsJobsDF3</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">state_names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_names_dict</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Work_State</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">state_names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_names_dict</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Employer_State</span><span class="p">])</span>
<span class="n">dsJobsDF4</span> <span class="o">=</span> <span class="n">dsJobsDF3</span>
<span class="n">dsJobsDF4</span><span class="p">[</span><span class="s">"Work_State_Code"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsJobsDF4</span><span class="o">.</span><span class="n">Work_State</span>
<span class="n">dsJobsDF4</span><span class="p">[</span><span class="s">"Work_State"</span><span class="p">]</span> <span class="o">=</span> <span class="n">state_names_list</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>dsJobsDF3: (283323, 17)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now remove the extraneous rows in the price parity data and merge the parity and work visa datasets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">parityDF2</span> <span class="o">=</span> <span class="n">parityDF</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
<span class="n">parityDF2</span> <span class="o">=</span> <span class="n">parityDF2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'State'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">'parityDF2: {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parityDF2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">dsJobsDF5</span> <span class="o">=</span> <span class="n">dsJobsDF4</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">parityDF2</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s">'Work_State'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s">'State'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'dsJobsDF5: {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>parityDF2: (51, 2)
dsJobsDF5: (283323, 20)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're ready to use the price parity information to adjust salary to reflect regional cost of living differences. Notice that not all states have price parity information; there is <code>nan</code> in the <code>Price_Deflator</code> column below. We should replace <code>nan</code> with <strong>100.0</strong> so salaries for those states remain unchanged after adjusting for cost of living differences.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="s">'nan present'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">Price_Deflator</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="n">where_are_NaNs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">Price_Deflator</span><span class="p">)</span>
<span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">Price_Deflator</span><span class="p">[</span><span class="n">where_are_NaNs</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="k">print</span><span class="p">(</span><span class="s">'nan replaced with 100.0'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">Price_Deflator</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>nan present
[    nan  120.     94.9   102.9   122.75  107.5   104.05  118.1   122.1
  114.1   105.35  115.95  110.     97.65  109.8   104.95  108.25   94.75
   97.9   103.8    95.35   97.35   96.6   112.75  105.15   92.3    93.65
  104.9   100.6    99.2   108.65   95.8    96.65   97.3    99.3    93.3
   96.05  104.8   124.35  103.6   102.3   113.15   94.3    96.4    97.1
   93.95  107.    101.3   104.4   100.3 ]


nan replaced with 100.0
[ 100.    120.     94.9   102.9   122.75  107.5   104.05  118.1   122.1
  114.1   105.35  115.95  110.     97.65  109.8   104.95  108.25   94.75
   97.9   103.8    95.35   97.35   96.6   112.75  105.15   92.3    93.65
  104.9   100.6    99.2   108.65   95.8    96.65   97.3    99.3    93.3
   96.05  104.8   124.35  103.6   102.3   113.15   94.3    96.4    97.1
   93.95  107.    101.3   104.4   100.3 ]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're ready to adjust salary with the price parity information. This isn't perfect because we're using price parity information from <strong>2012 and 2013</strong> to adjust salary information from <strong>2002 to 2015</strong>. However, it seems likely that inflation shows consistent trend from year to year among states. For e.g., New York has been more expensive to live in than Iowa for as long as we can remember.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">salary_offered_adjusted</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">salary_prevailing_adjusted</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dsJobsDF5</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">salary_offered_adjusted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Salary_Offered'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Price_Deflator'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>
    <span class="n">salary_prevailing_adjusted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Salary_Prevailing'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Price_Deflator'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>
    
<span class="n">dsJobsDF6</span> <span class="o">=</span> <span class="n">dsJobsDF5</span>
<span class="n">dsJobsDF6</span><span class="p">[</span><span class="s">"Offered_Salary_Adjusted"</span><span class="p">]</span> <span class="o">=</span> <span class="n">salary_offered_adjusted</span>
<span class="n">dsJobsDF6</span><span class="p">[</span><span class="s">"Prevailing_Salary_Adjusted"</span><span class="p">]</span> <span class="o">=</span> <span class="n">salary_prevailing_adjusted</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Time to adjust salary for inflation --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Time to adjust salary for inflation --- 59.78936195373535 seconds ---
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Add-population-information">Add population information<a class="anchor-link" href="#Add-population-information">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simply knowing that California has <strong>30,000</strong> data science related jobs compared to say <strong>3500</strong> for Alaska really does not tell us all that much. Ideally, we want relative truth where we can get a sense of the number of H1B jobs per capita. So let's add population information from census.gov to help us do that.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'http://www.census.gov/popest/data/state/totals/2015/tables/NST-EST2015-01.xlsx'</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">xl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="n">sheet_names</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">sheet_names</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">DF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"State"</span><span class="p">,</span> <span class="s">"Census"</span><span class="p">,</span> <span class="s">"Estimates Base"</span><span class="p">,</span> <span class="s">"2010"</span><span class="p">,</span> <span class="s">"2011"</span><span class="p">,</span> <span class="s">"2012"</span><span class="p">,</span> <span class="s">"2013"</span><span class="p">,</span> <span class="s">"2014"</span><span class="p">,</span> <span class="s">"Census_2015"</span><span class="p">]</span>
<span class="n">censusDF</span> <span class="o">=</span> <span class="n">DF</span><span class="p">[[</span><span class="s">"State"</span><span class="p">,</span> <span class="s">"Census_2015"</span><span class="p">]]</span>
<span class="n">censusDF</span> <span class="o">=</span> <span class="n">censusDF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">51</span><span class="p">,]</span>
<span class="k">print</span><span class="p">(</span><span class="n">censusDF</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="c"># Remove dot sign from the State column</span>
<span class="n">censusDF</span><span class="p">[</span><span class="s">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="n">censusDF</span><span class="p">[</span><span class="s">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\.'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="n">censusDF</span><span class="p">[</span><span class="s">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="n">censusDF</span><span class="p">[</span><span class="s">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

<span class="c"># Add population of US territories not included in the data source</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s">'Puerto Rico'</span><span class="p">,</span> <span class="mi">3474182</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Guam'</span><span class="p">,</span> <span class="mi">159358</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Virgin Islands'</span><span class="p">,</span> <span class="mi">106405</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'American Samoa'</span><span class="p">,</span> <span class="mi">55519</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Northern Mariana Islands'</span><span class="p">,</span> <span class="mi">53883</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Palau'</span><span class="p">,</span> <span class="mi">20918</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Federated States Of Micronesia'</span><span class="p">,</span> <span class="mi">103549</span><span class="p">],</span>
                   <span class="p">[</span><span class="s">'Marshall Islands'</span><span class="p">,</span> <span class="mi">52634</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"State"</span><span class="p">,</span> <span class="s">"Census_2015"</span><span class="p">])</span>
<span class="n">censusDF</span> <span class="o">=</span> <span class="n">censusDF</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">censusDF</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"censusDF: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">censusDF</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time to read and clean census data --- </span><span class="si">%s</span><span class="s"> seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>         State  Census_2015
0     .Alabama    4858979.0
1      .Alaska     738432.0
2     .Arizona    6828065.0
3    .Arkansas    2978204.0
4  .California   39144818.0


        State  Census_2015
0     Alabama    4858979.0
1      Alaska     738432.0
2     Arizona    6828065.0
3    Arkansas    2978204.0
4  California   39144818.0


censusDF: (59, 2)
Time to read and clean census data --- 0.40192627906799316 seconds ---
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can add the census data to our work visa data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dsJobsDF7</span> <span class="o">=</span> <span class="n">dsJobsDF6</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">censusDF</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s">'Work_State'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s">'State'</span><span class="p">)</span>
<span class="n">dsJobsDF7</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(283323, 24)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prune-data">Prune data<a class="anchor-link" href="#Prune-data">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this point, we can drop columns we don't need. Here are the columns in our dataset.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dsJobsDF7</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Index([&apos;Submitted_Date&apos;, &apos;Case_Number&apos;, &apos;Employer_Name&apos;, &apos;Employer_City&apos;,
       &apos;Employer_State&apos;, &apos;Employer_Postal_Code&apos;, &apos;Job_Title&apos;,
       &apos;Approval_Status&apos;, &apos;Wage_Rate&apos;, &apos;Wage_Rate_Unit&apos;, &apos;Part_Time&apos;,
       &apos;Work_City&apos;, &apos;Work_State&apos;, &apos;Prevailing_Wage&apos;, &apos;Job_Title_revised&apos;,
       &apos;Salary_Offered&apos;, &apos;Salary_Prevailing&apos;, &apos;Work_State_Code&apos;, &apos;State_x&apos;,
       &apos;Price_Deflator&apos;, &apos;Offered_Salary_Adjusted&apos;,
       &apos;Prevailing_Salary_Adjusted&apos;, &apos;State_y&apos;, &apos;Census_2015&apos;],
      dtype=&apos;object&apos;)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dsJobsDF_final</span> <span class="o">=</span> <span class="n">dsJobsDF7</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dsJobsDF7</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">22</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Job_Title_revised'</span><span class="p">:</span><span class="s">'Job_Category'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's our final dataset after dropping some columns.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"dsJobsDF_final has {0} rows and {1} columns"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Index([&apos;Submitted_Date&apos;, &apos;Employer_Name&apos;, &apos;Work_City&apos;, &apos;Work_State&apos;,
       &apos;Job_Category&apos;, &apos;Work_State_Code&apos;, &apos;Price_Deflator&apos;,
       &apos;Offered_Salary_Adjusted&apos;, &apos;Prevailing_Salary_Adjusted&apos;, &apos;Census_2015&apos;],
      dtype=&apos;object&apos;)


dsJobsDF_final has 283323 rows and 10 columns
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Persist-data">Persist data<a class="anchor-link" href="#Persist-data">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data is now ready for prime time! We're going to explore it in <a href="https://sedeh.github.io/where-the-datascience-jobs-are-part2.html">Where the data science related jobs are (part2)</a>. Before we save the data, let's quickly convert the date string in <code>Submitted_Date</code> column to <code>datetime</code> and then we can save away.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">Submitted_Date</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">dsJobsDF_final</span><span class="p">[</span><span class="s">"Submitted_Date"</span><span class="p">]</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date_string</span><span class="p">)</span> <span class="k">for</span> <span class="n">date_string</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
<span class="n">dsJobsDF_final</span><span class="p">[</span><span class="s">"Submitted_Date"</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">Submitted_Date</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><class &amp;apos;str&amp;apos;>
<class &amp;apos;pandas.tslib.timestamp&amp;apos;>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dsJobsDF_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataScienceJobs.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="s">"Total time --- </span><span class="si">%s</span><span class="s"> minutes ---"</span> <span class="o">%</span> <span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">total_time</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Total time --- 12.587802549203237 minutes ---
</pre>
</div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://sedeh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>